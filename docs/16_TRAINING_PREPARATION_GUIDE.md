# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∫ –æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏

## üìä –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–í—Å–µ–≥–æ —Ñ–∏—á–µ–π:** 162
- **–û–±—Ä–∞–∑—Ü–æ–≤ –≤ train:** 123,003
- **–ü—Ä–æ–±–ª–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã:** –î–∞, —Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

### 1. Data Leakage - –±—É–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∏—á–∞—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∏—á–∏ `future_return_*` –∏–º–µ—é—Ç –æ—á–µ–Ω—å –≤—ã—Å–æ–∫—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å —Ç–∞—Ä–≥–µ—Ç–æ–º –∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—é –º–µ–∂–¥—É –∫–ª–∞—Å—Å–∞–º–∏.

**–î–µ—Ç–∞–ª–∏:**
- `future_return_30`: CV = 3537.08 (–æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—è)
- `future_return_5`: CV = 223.50
- `future_return_60`: CV = 109.88
- `max_future_return`: –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è = 0.4763 (—Å–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è!)

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–∏ —Ñ–∏—á–∏ –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ –æ–±—É—á–µ–Ω–∏—è
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ prepare_gold_data.py, —á—Ç–æ future_return_* –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Ñ–∏—á–∏
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
import pandas as pd
train_df = pd.read_csv('workspace/prepared/features/gold_train.csv', index_col=0)
future_features = [c for c in train_df.columns if 'future_return' in c or 'max_future_return' in c]
print("–§–∏—á–∏ —Å future_return:", future_features)
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞, –Ω–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
```

### 2. –§–∏—á–∏ —Å 100% –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–∏ —Ñ–∏—á–∏ –Ω–µ –Ω–µ—Å—É—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ —Ç–æ–ª—å–∫–æ –∑–∞—Å–æ—Ä—è—é—Ç –º–æ–¥–µ–ª—å.

**–§–∏—á–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:**
- `real_volume` - 100% –Ω—É–ª–µ–π
- `is_weekend` - 100% –Ω—É–ª–µ–π

**–î–µ–π—Å—Ç–≤–∏–µ:**
```python
# –î–æ–±–∞–≤—å—Ç–µ –≤ —Å–ø–∏—Å–æ–∫ –∏—Å–∫–ª—é—á–∞–µ–º—ã—Ö —Ñ–∏—á–µ–π –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö
exclude_features = ['real_volume', 'is_weekend']
```

### 3. –§–∏—á–∏ —Å –±–æ–ª—å—à–∏–º –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –ø—Ä–æ–ø—É—Å–∫–æ–≤ (>90%)

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–∏ —Ñ–∏—á–∏ –∏–º–µ—é—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

**–§–∏—á–∏ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ >90%:**
- `resistance_width` - 93.84%
- `distance_to_resistance_sigma` - 93.84%
- `proximity_to_resistance` - 93.84%
- `proximity_to_resistance_atr` - 93.84%
- `support_level` - 93.79%
- `support_width` - 93.79%
- `distance_to_support_sigma` - 93.79%
- `distance_to_support_atr` - 93.79%
- `proximity_to_support` - 93.79%
- `proximity_to_support_atr` - 93.79%

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- **–í–∞—Ä–∏–∞–Ω—Ç 1:** –£–¥–∞–ª–∏—Ç—å —ç—Ç–∏ —Ñ–∏—á–∏ (–µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã)
- **–í–∞—Ä–∏–∞–Ω—Ç 2:** –£–ª—É—á—à–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è support/resistance —É—Ä–æ–≤–Ω–µ–π
- **–í–∞—Ä–∏–∞–Ω—Ç 3:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –æ–Ω–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã (—Å–æ–∑–¥–∞—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–ª–∞–≥)

**–î–µ–π—Å—Ç–≤–∏–µ:**
```python
# –î–æ–±–∞–≤—å—Ç–µ –≤ —Å–ø–∏—Å–æ–∫ –∏—Å–∫–ª—é—á–∞–µ–º—ã—Ö —Ñ–∏—á–µ–π
high_missing_features = [
    'resistance_width', 'distance_to_resistance_sigma',
    'proximity_to_resistance', 'proximity_to_resistance_atr',
    'support_level', 'support_width', 'distance_to_support_sigma',
    'distance_to_support_atr', 'proximity_to_support', 'proximity_to_support_atr'
]
```

### 4. –§–∏—á–∏ —Å —É–º–µ—Ä–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ (40-50%)

**–§–∏—á–∏:**
- `psar` - 48.31% –ø—Ä–æ–ø—É—Å–∫–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å, –Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–ª–∞–≥–∞ "psar_available"

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (—Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è)

### 5. –§–∏—á–∏ —Å –±–æ–ª—å—à–∏–º –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –≤—ã–±—Ä–æ—Å–æ–≤ (>15%)

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–±—Ä–æ—Å–æ–≤ –º–æ–∂–µ—Ç —É—Ö—É–¥—à–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏.

**–¢–æ–ø —Ñ–∏—á–µ–π —Å –≤—ã–±—Ä–æ—Å–∞–º–∏:**
- `proximity_to_support_atr` - 23.21% –≤—ã–±—Ä–æ—Å–æ–≤
- `proximity_to_resistance_atr` - 23.19% –≤—ã–±—Ä–æ—Å–æ–≤
- `spread` - 17.34% –≤—ã–±—Ä–æ—Å–æ–≤
- `volume_price_trend` - 16.37% –≤—ã–±—Ä–æ—Å–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å robust scaling (RobustScaler –≤–º–µ—Å—Ç–æ StandardScaler)
- –ò–ª–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å clipping –∫ –≤—ã–±—Ä–æ—Å–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1-99 –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏)

**–î–µ–π—Å—Ç–≤–∏–µ:**
```python
# –í data_loader.py –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ RobustScaler –¥–ª—è —Ñ–∏—á–µ–π —Å –≤—ã–±—Ä–æ—Å–∞–º–∏
from sklearn.preprocessing import RobustScaler
# RobustScaler –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–¥–∏–∞–Ω—É –∏ IQR, –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤ –∫ –≤—ã–±—Ä–æ—Å–∞–º
```

### 6. –ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–Ω–∞–ª–∏–∑–æ–º –≤–∞–∂–Ω–æ—Å—Ç–∏ —Ñ–∏—á–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ —Ñ–∏—á–∏ –∏–º–µ—é—Ç `combined_score = 0`, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ Mutual Information –∏ F-score –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç.

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º –º–µ—Ç—Ä–∏–∫ –≤ `analyze_features_comprehensive.py`
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å —Ç–∞—Ä–≥–µ—Ç–æ–º (–æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é –º–µ—Ç—Ä–∏–∫—É –≤–∞–∂–Ω–æ—Å—Ç–∏

**–¢–æ–ø —Ñ–∏—á–µ–π –ø–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å —Ç–∞—Ä–≥–µ—Ç–æ–º:**
1. `max_future_return` - 0.4763 ‚ö†Ô∏è (data leakage!)
2. `atr_14` - 0.2743
3. `atr_6` - 0.2642
4. `gk_vol_50` - 0.2597
5. `volume_ma_5` - 0.2518
6. `volume_ma_20` - 0.2475
7. `realized_vol_20` - 0.2433
8. `volume` - 0.2418
9. `realized_vol_10` - 0.2279
10. `hl_spread` - 0.2138

---

## ‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ü–û–î–ì–û–¢–û–í–ö–ï –ö –û–ë–£–ß–ï–ù–ò–Æ

### –®–∞–≥ 1: –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

**–°–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ —Ñ–∏—á–µ–π –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è:**

```python
# –§–∏—á–∏ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
EXCLUDE_FEATURES = [
    # Data leakage
    'max_future_return',
    'future_return_1', 'future_return_5', 'future_return_10',
    'future_return_20', 'future_return_30', 'future_return_60',
    
    # 100% –Ω—É–ª–µ–π
    'real_volume', 'is_weekend',
    
    # –ë–æ–ª—å—à–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ (>90%)
    'resistance_width', 'distance_to_resistance_sigma',
    'proximity_to_resistance', 'proximity_to_resistance_atr',
    'support_level', 'support_width', 'distance_to_support_sigma',
    'distance_to_support_atr', 'proximity_to_support', 'proximity_to_support_atr',
    
    # –°–ª—É–∂–µ–±–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
    'signal_class_name'
]
```

**–î–µ–π—Å—Ç–≤–∏–µ:**
1. –û–±–Ω–æ–≤–∏—Ç–µ `prepare_gold_data.py` –∏–ª–∏ `data/gold_data_prep.py` –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —ç—Ç–∏—Ö —Ñ–∏—á–µ–π
2. –ü–µ—Ä–µ–ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ:
```bash
python prepare_gold_data.py --months 6 --force-regenerate
```

### –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤

**–í–∞—Ä–∏–∞–Ω—Ç A: Robust Scaling (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```python
# –í models/data_loader.py –∑–∞–º–µ–Ω–∏—Ç–µ StandardScaler –Ω–∞ RobustScaler
from sklearn.preprocessing import RobustScaler
self.scaler = RobustScaler()
```

**–í–∞—Ä–∏–∞–Ω—Ç B: Clipping –≤—ã–±—Ä–æ—Å–æ–≤**
```python
# –û–±—Ä–µ–∂—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ 1-99 –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–µ–π
for col in feature_columns:
    q1 = df[col].quantile(0.01)
    q99 = df[col].quantile(0.99)
    df[col] = df[col].clip(lower=q1, upper=q99)
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤

**–ü–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:**
```python
import pandas as pd
train_df = pd.read_csv('workspace/prepared/features/gold_train.csv', index_col=0)
print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤:")
print(train_df['signal_class'].value_counts(normalize=True) * 100)
```

**–û–∂–∏–¥–∞–µ–º–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
- –ö–ª–∞—Å—Å 0 (–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å): ~50-60%
- –ö–ª–∞—Å—Å 1 (–ü—Ä–æ–±–æ–π –≤–≤–µ—Ä—Ö): ~10-15%
- –ö–ª–∞—Å—Å 2 (–ü—Ä–æ–±–æ–π –≤–Ω–∏–∑): ~10-15%
- –ö–ª–∞—Å—Å 3 (–û—Ç—Å–∫–æ–∫ –≤–≤–µ—Ä—Ö): ~3-7%
- –ö–ª–∞—Å—Å 4 (–û—Ç—Å–∫–æ–∫ –≤–Ω–∏–∑): ~3-7%

**–ï—Å–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `class_weights` –≤ loss —Ñ—É–Ω–∫—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--class-weight-method balanced` –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏

### –®–∞–≥ 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∏—á–µ–π (—É–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—ã—Å–æ–∫–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∏—á–µ–π
python full_pipeline.py --months 6 --remove-correlated --correlation-threshold 0.95
```

**–≠—Ç–æ —É–¥–∞–ª–∏—Ç:**
- –§–∏—á–∏ —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π > 0.95
- –°–æ—Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É —Ñ–∏—á—É –∏–∑ –∫–∞–∂–¥–æ–π –≤—ã—Å–æ–∫–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞—Ä—ã
- –ó–∞—â–∏—Ç–∏—Ç –±–∞–∑–æ–≤—ã–µ —Ñ–∏—á–∏ (open, high, low, close)

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ 123k –æ–±—Ä–∞–∑—Ü–æ–≤ –∏ 60 —à–∞–≥–∞—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –Ω–µ —Ö–≤–∞—Ç–∏—Ç—å –ø–∞–º—è—Ç–∏.

**–†–∞—Å—á–µ—Ç:**
- –û–±—Ä–∞–∑—Ü–æ–≤: 123,003
- –î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: 60
- –§–∏—á–µ–π –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏: ~140-150
- –†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞: 123,003 √ó 60 √ó 150 √ó 4 bytes (float32) ‚âà 4.4 GB

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `float32` (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∞—Ç—á–∏ (batch_size=32)
- ‚úÖ –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ `sequence_length` –¥–æ 30-40, –µ—Å–ª–∏ –ø–∞–º—è—Ç–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Paperspace –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (30 GB RAM)

### –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è:**

```bash
python train_all_models.py \
  --batch-size 32 \
  --epochs 100 \
  --patience 10 \
  --months 6 \
  --class-weight-method balanced
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏:**
- `sequence_length`: 60 (–º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ 30-40 –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏)
- `batch_size`: 32 (–º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ 16, –µ—Å–ª–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –ø–∞–º—è—Ç–∏)
- `learning_rate`: 0.0001 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `dropout`: 0.1-0.2 (–¥–ª—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏)

---

## üìã –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –û–ë–£–ß–ï–ù–ò–ï–ú

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

- [ ] **–£–¥–∞–ª–µ–Ω—ã —Ñ–∏—á–∏ —Å data leakage** (future_return_*)
- [ ] **–£–¥–∞–ª–µ–Ω—ã —Ñ–∏—á–∏ —Å 100% –Ω—É–ª–µ–π** (real_volume, is_weekend)
- [ ] **–£–¥–∞–ª–µ–Ω—ã –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã —Ñ–∏—á–∏ —Å >90% –ø—Ä–æ–ø—É—Å–∫–æ–≤**
- [ ] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤** (–Ω–µ —Å–ª–∏—à–∫–æ–º –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ)
- [ ] **–£–¥–∞–ª–µ–Ω—ã –≤—ã—Å–æ–∫–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏—á–∏** (correlation > 0.95)
- [ ] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞—è –ø–∞–º—è—Ç—å** (–º–∏–Ω–∏–º—É–º 8 GB –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è)
- [ ] **–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã class_weights** (–¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤)
- [ ] **–í—ã–±—Ä–∞–Ω –ø–æ–¥—Ö–æ–¥—è—â–∏–π scaler** (RobustScaler –¥–ª—è –¥–∞–Ω–Ω—ã—Ö —Å –≤—ã–±—Ä–æ—Å–∞–º–∏)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

- [ ] **–ü—Ä–æ–≤–µ–¥–µ–Ω –∞–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Ñ–∏—á–µ–π** (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞)
- [ ] **–û–±—Ä–∞–±–æ—Ç–∞–Ω—ã –≤—ã–±—Ä–æ—Å—ã** (clipping –∏–ª–∏ robust scaling)
- [ ] **–°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –¥–∞–Ω–Ω—ã—Ö** –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- [ ] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö** (–Ω–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã)

---

## üöÄ –ü–û–†–Ø–î–û–ö –î–ï–ô–°–¢–í–ò–ô

### 1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–∫—Ä–∏—Ç–∏—á–Ω–æ):

```bash
# 1. –ò—Å–∫–ª—é—á–∏—Ç–µ —Ñ–∏—á–∏ —Å data leakage –∏ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ñ–∏—á–∏
# –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö

# 2. –ü–µ—Ä–µ–ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ
python prepare_gold_data.py --months 6 --force-regenerate

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
python -c "import pandas as pd; df = pd.read_csv('workspace/prepared/features/gold_train.csv', index_col=0); print('–§–∏—á–µ–π:', len([c for c in df.columns if c not in ['signal_class', 'signal_class_name', 'max_future_return']])); print('–ö–ª–∞—Å—Å—ã:', df['signal_class'].value_counts())"
```

### 2. –ü–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º:

```bash
# 1. –£–¥–∞–ª–∏—Ç–µ –≤—ã—Å–æ–∫–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏—á–∏
python full_pipeline.py --months 6 --remove-correlated --correlation-threshold 0.95

# 2. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ —Ñ–∏—á–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
python full_pipeline.py --months 6 --analyze-features

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ
python train_all_models.py \
  --batch-size 32 \
  --epochs 100 \
  --patience 10 \
  --months 6 \
  --class-weight-method balanced
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ TensorBoard –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
python utils/start_tensorboard.py

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ W&B
python train_all_models.py --use-wandb --wandb-project xauusd-ai-ea
```

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏—á–µ–π:** ~140-150 (–ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏—á–µ–π –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π:** ~100-120
- **–ö–∞—á–µ—Å—Ç–≤–æ —Ñ–∏—á–µ–π:** –¢–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ, –±–µ–∑ data leakage
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤:** –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–ª–∏ —Å class_weights

### –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è:

- **Train accuracy:** > 60-70% (–¥–ª—è 5 –∫–ª–∞—Å—Å–æ–≤ —ç—Ç–æ —Ö–æ—Ä–æ—à–æ)
- **Val accuracy:** –í –ø—Ä–µ–¥–µ–ª–∞—Ö 5-10% –æ—Ç train accuracy
- **Val loss:** –î–æ–ª–∂–µ–Ω —É–º–µ–Ω—å—à–∞—Ç—å—Å—è, –Ω–µ —Ä–∞—Å—Ç–∏
- **Class-wise F1:** > 0.5 –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ (–∫—Ä–æ–º–µ —Ä–µ–¥–∫–∏—Ö)

---

## üîß –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏:

1. **Feature Engineering:**
   - –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≤–∞–∂–Ω—ã—Ö —Ñ–∏—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, volume √ó volatility)
   - –î–æ–±–∞–≤—å—Ç–µ –ª–∞–≥–∏ –¥–ª—è –≤–∞–∂–Ω—ã—Ö —Ñ–∏—á–µ–π
   - –°–æ–∑–¥–∞–π—Ç–µ rolling statistics –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫

2. **–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ dropout (0.1-0.2)
   - –î–æ–±–∞–≤—å—Ç–µ weight decay
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ early stopping

3. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
   - –ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª–∏ (encoder)
   - –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ö–æ—Ä–æ—à–∏–µ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ timeseries –º–æ–¥–µ–ª—å
   - –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å sequence_length (30, 60, 90)

4. **–î–∞–Ω–Ω—ã–µ:**
   - –£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—è—Ü–µ–≤ –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ data augmentation (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö (–Ω–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤, –ø—Ä–æ–ø—É—Å–∫–æ–≤)

---

## üìù –ó–ê–ú–ï–¢–ö–ò

- **–ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–Ω–∞–ª–∏–∑–æ–º –≤–∞–∂–Ω–æ—Å—Ç–∏:** Mutual Information –∏ F-score –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç (–≤—Å–µ = 0). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É.
- **–í—ã–±—Ä–æ—Å—ã:** –ú–Ω–æ–≥–æ —Ñ–∏—á–µ–π —Å –≤—ã–±—Ä–æ—Å–∞–º–∏ >15%. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ RobustScaler.
- **–ü–∞–º—è—Ç—å:** –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Paperspace –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç–µ sequence_length.

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç `workspace/features-analysis/`

